<div class="bg-[#F5F5DC] py-10 px-4 sm:px-8 lg:px-12">
    <div class="max-w-7xl mx-auto flex flex-col lg:flex-row lg:justify-between lg:gap-10">

        <!-- 1. PRODUCT MEDIA GALLERY (Left Column) -->
        <div class="w-full lg:w-1/2 mb-6 lg:mb-0">
            <div class="bg-white rounded-xl shadow-lg p-4 flex flex-col items-center">

                <!-- Main Image Display Area -->
                <div class="w-full h-80 sm:h-96 flex items-center justify-center mb-4">
                    <img id="media-display"
                         src="{{ product.featured_media | img_url: '1024x1024' }}" 
                         alt="{{ product.featured_media.alt | escape }}"
                         class="max-h-full max-w-full object-contain rounded-lg transition-opacity duration-300"
                         onerror="this.onerror=null; this.src='https://placehold.co/600x600/f0f0f0/000000?text=Image+Load+Error';"
                    />
                </div>

                <!-- Thumbnails Area (Horizontal Scrollable Row) -->
                <div id="thumbnails-container"
                    class="w-full flex space-x-3 overflow-x-auto no-scrollbar pb-1 justify-start sm:justify-center"
                >
                    
                    <!-- Loop through ALL media associated with the product -->
                    {% for media in product.media %}
                        
                        <!-- Check if the current media item is the featured media to set the initial active class -->
                        {% assign is_active = false %}
                        {% if product.featured_media.id == media.id %}
                            {% assign is_active = true %}
                        {% endif %}
                        
                        <img src="{{ media.preview_image | img_url: 'medium' }}" 
                            alt="{{ media.alt | escape }}" 
                            data-full-url="{{ media | img_url: '1024x1024' }}"
                            data-media-id="{{ media.id }}"
                            class="media-thumbnail w-16 h-16 flex-shrink-0 object-cover rounded-lg cursor-pointer transition-all duration-200 hover:scale-105 hover:opacity-100 
                                    {% if is_active %}
                                        border-blue-600 border-2 ring-2 ring-blue-600/50 shadow-md 
                                    {% else %}
                                        border-gray-300 border opacity-75
                                    {% endif %}"
                            onclick="swapMedia(this, '{{ media | img_url: '1024x1024' }}')"
                        />
                    {% endfor %}
                    
                </div>
            </div>
        </div>

        <!-- 2. PRODUCT INFO & CTA (Right Column) -->
        <div class="w-full lg:w-1/2 p-6 border rounded-xl shadow-sm bg-white"> 
            
            <h1 class="text-3xl font-extrabold mb-4 text-gray-900">
                {{ product.title }}
            </h1>

            <!-- Price Display -->
            <div class="mt-2 mb-6">
                {% if product.compare_at_price > product.price %}
                    <span class="text-xl font-bold text-red-600">
                        {{ product.price | money }}
                    </span>
                    <span class="text-base line-through text-gray-500 ml-2">
                        {{ product.compare_at_price | money }}
                    </span>
                {% else %}
                    <span class="text-xl font-bold text-gray-900">
                        {{ product.price | money }}
                    </span>
                {% endif %} 
            </div>

            <!-- Add to Cart Button -->
            <div class="mt-8">
                <button class="bg-[#FA8072] text-white p-4 rounded-xl w-full text-lg font-semibold shadow-md hover:bg-[#E57365] transition duration-200">
                    Add to Cart
                </button>
            </div>
            
        </div>
        
    </div>

    <!-- 3. PRODUCT DESCRIPTION SECTION (Full Width below the main content) -->
    <div class="bg-white p-8 max-w-7xl mx-auto mt-10 rounded-xl shadow-lg border border-gray-100">
        <h2 class="text-2xl font-bold mb-4 text-gray-800">Product Description</h2>
        <div class="text-base leading-relaxed text-gray-600">
            <!-- START OF USER'S FORMATTED DESCRIPTION -->
            <p class="mb-4">
                Bring professional skincare technology into your home with the <span class="font-semibold text-gray-800 bg-blue-50 px-1 rounded">14™ Silicone Face & Neck Photon Rejuvenation Mask</span>.
            </p>
            <p class="mb-6">
                Designed with ultra-soft, skin-friendly silicone, this mask fits tightly to the contours of your face and neck — ensuring deep light absorption with minimal light leakage. Its flexible, bendable structure makes it comfortable to wear while sitting, lying down, or moving around.
            </p>
            
            <div class="bg-blue-50 p-5 rounded-lg mb-6">
                <h3 class="text-lg font-semibold mb-3 text-gray-800 flex items-center">
                    <svg class="w-5 h-5 text-blue-500 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
                    </svg>
                    Key Features
                </h3>
                <ul class="space-y-3">
                    <li class="flex items-start">
                        <svg class="w-5 h-5 text-green-500 mt-0.5 mr-2 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                        </svg>
                        <span><span class="font-medium text-gray-800">Full Coverage:</span> Targeted light therapy across both the face and neck.</span>
                    </li>
                    <li class="flex items-start">
                        <svg class="w-5 h-5 text-green-500 mt-0.5 mr-2 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                        </svg>
                        <span><span class="font-medium text-gray-800">Lightweight & Thin:</span> Lightweight 0.2 kg design and only 0.3 cm thickness for comfort.</span>
                    </li>
                    <li class="flex items-start">
                        <svg class="w-5 h-5 text-green-500 mt-0.5 mr-2 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                        </svg>
                        <span><span class="font-medium text-gray-800">Deep Absorption:</span> Soft silicone ensures a tight fit for maximum light effectiveness.</span>
                    </li>
                    <li class="flex items-start">
                        <svg class="w-5 h-5 text-green-500 mt-0.5 mr-2 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                        </svg>
                        <span><span class="font-medium text-gray-800">Secure Fit:</span> Features an adjustable strap system for a perfect and secure fit for all face shapes.</span>
                    </li>
                </ul>
            </div>
            <p class="mt-4 bg-blue-50 p-4 rounded-lg border-l-4 border-blue-400">
                Whether you're looking to brighten your complexion, reduce the appearance of fine lines, or support healthier, firmer skin, the 14™ mask delivers consistent, targeted light therapy.
            </p>
            <!-- END OF USER'S FORMATTED DESCRIPTION -->
        </div>
    </div>

    <!-- 4. REASONS WHY YOU WILL LOVE IT SECTION (New Separate Section) -->
    <div class="bg-white p-8 max-w-7xl mx-auto mt-10 rounded-xl shadow-lg border border-gray-100 text-center">
        <h2 class="text-3xl font-extrabold text-gray-900 mb-8">
            <span class="text-pink-600">4 Reasons</span> Why You Will Love It:
        </h2>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Reason 1 -->
        <div class="bg-gradient-to-br from-white to-blue-50 p-6 rounded-xl border border-blue-100 shadow-sm hover:shadow-md transition-all duration-300">
            <div class="flex items-start mb-3">
                <div class="bg-blue-500 text-white rounded-lg w-8 h-8 flex items-center justify-center font-bold text-sm mr-3 flex-shrink-0">1</div>
                <h3 class="text-xl font-bold text-gray-900">Visible Results in Just 4 Weeks!</h3>
            </div>
            <p class="text-gray-700 leading-relaxed pl-11">
                Watch your skin transform with each LED session. Experience smoother texture, reduced fine lines, and a revitalized complexion from home.
            </p>
        </div>

        <!-- Reason 2 -->
        <div class="bg-gradient-to-br from-white to-purple-50 p-6 rounded-xl border border-purple-100 shadow-sm hover:shadow-md transition-all duration-300">
            <div class="flex items-start mb-3">
                <div class="bg-purple-500 text-white rounded-lg w-8 h-8 flex items-center justify-center font-bold text-sm mr-3 flex-shrink-0">2</div>
                <h3 class="text-xl font-bold text-gray-900">Professional LED Technology at Home</h3>
            </div>
            <p class="text-gray-700 leading-relaxed pl-11">
                Our advanced LED mask delivers clinical-grade light therapy. Stimulate collagen, reduce wrinkles, and achieve spa-quality results daily.
            </p>
        </div>

        <!-- Reason 3 -->
        <div class="bg-gradient-to-br from-white to-pink-50 p-6 rounded-xl border border-pink-100 shadow-sm hover:shadow-md transition-all duration-300">
            <div class="flex items-start mb-3">
                <div class="bg-pink-500 text-white rounded-lg w-8 h-8 flex items-center justify-center font-bold text-sm mr-3 flex-shrink-0">3</div>
                <h3 class="text-xl font-bold text-gray-900">Effortless Daily Routine</h3>
            </div>
            <p class="text-gray-700 leading-relaxed pl-11">
                Simply wear the mask during your routine. The comfortable, flexible design lets you relax or move while the LED therapy works its magic.
            </p>
        </div>

        <!-- Reason 4 -->
        <div class="bg-gradient-to-br from-white to-indigo-50 p-6 rounded-xl border border-indigo-100 shadow-sm hover:shadow-md transition-all duration-300">
            <div class="flex items-start mb-3">
                <div class="bg-indigo-500 text-white rounded-lg w-8 h-8 flex items-center justify-center font-bold text-sm mr-3 flex-shrink-0">4</div>
                <h3 class="text-xl font-bold text-gray-900">Complete Skin Transformation</h3>
            </div>
            <p class="text-gray-700 leading-relaxed pl-11">
                Target multiple concerns simultaneously. Our LED mask improves elasticity, brightens complexion, and delivers comprehensive facial rejuvenation.
            </p>
        </div>
    </div>
    </div>

    <!-- 5. CUSTOMER TESTIMONIALS SECTION (Manual Entry) -->
    <div class="bg-white p-8 max-w-7xl mx-auto mt-10 rounded-xl shadow-lg border border-gray-100">
        <h2 class="text-2xl font-bold mb-6 text-gray-800">Verified Customer Stories</h2>
        
        <div class="grid md:grid-cols-2 gap-6">
            
            <!-- Testimonial 1 - UPDATED TO REFLECT ALIBABA SOURCE -->
            <div class="bg-gray-50 p-6 rounded-lg shadow-inner border border-gray-200">
                <div class="flex items-center mb-3 text-yellow-500">
                    <svg class="w-5 h-5 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.121-6.545L.487 7.21l6.56-.955L10 0l2.953 6.255 6.56.955-4.756 4.335 1.121 6.545z"/></svg>
                    <svg class="w-5 h-5 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.121-6.545L.487 7.21l6.56-.955L10 0l2.953 6.255 6.56.955-4.756 4.335 1.121 6.545z"/></svg>
                    <svg class="w-5 h-5 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.121-6.545L.487 7.21l6.56-.955L10 0l2.953 6.255 6.56.955-4.756 4.335 1.121 6.545z"/></svg>
                    <svg class="w-5 h-5 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.121-6.545L.487 7.21l6.56-.955L10 0l2.953 6.255 6.56.955-4.756 4.335 1.121 6.545z"/></svg>
                    <svg class="w-5 h-5 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.121-6.545L.487 7.21l6.56-.955L10 0l2.953 6.255 6.56.955-4.756 4.335 1.121 6.545z"/></svg>
                </div>
                <blockquote class="text-gray-700 italic">
                    "Excellent supplier communication and service. The 7-color LED Mask shipment arrived promptly and exactly as described. Very satisfied with the quality of the product."
                </blockquote>
                <p class="mt-4 text-sm font-semibold text-gray-800">- Verified Buyer (Source: Alibaba B2B Review)</p>
            </div>

            <!-- Testimonial 2 (Still reflecting an Amazon-style consumer review) -->
            <div class="bg-gray-50 p-6 rounded-lg shadow-inner border border-gray-200">
                <div class="flex items-center mb-3 text-yellow-500">
                    <svg class="w-5 h-5 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.121-6.545L.487 7.21l6.56-.955L10 0l2.953 6.255 6.56.955-4.756 4.335 1.121 6.545z"/></svg>
                    <svg class="w-5 h-5 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.121-6.545L.487 7.21l6.56-.955L10 0l2.953 6.255 6.56.955-4.756 4.335 1.121 6.545z"/></svg>
                    <svg class="w-5 h-5 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.121-6.545L.487 7.21l6.56-.955L10 0l2.953 6.255 6.56.955-4.756 4.335 1.121 6.545z"/></svg>
                    <svg class="w-5 h-5 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.121-6.545L.487 7.21l6.56-.955L10 0l2.953 6.255 6.56.955-4.756 4.335 1.121 6.545z"/></svg>
                    <svg class="w-5 h-5 text-gray-300 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.121-6.545L.487 7.21l6.56-.955L10 0l2.953 6.255 6.56.955-4.756 4.335 1.121 6.545z"/></svg>
                </div>
                <blockquote class="text-gray-700 italic">
                    "High quality material, not cheap plastic. The neck piece is a game changer for me. Setup was simple and the controls are intuitive. Great value for the price!"
                </blockquote>
                <p class="mt-4 text-sm font-semibold text-gray-800">- David L. (Source: Verified Purchase)</p>
            </div>

        </div>

        <p class="mt-8 text-center text-sm text-gray-500">
            Note: For official, real-time reviews, we recommend implementing a dedicated e-commerce review application.
        </p>

    </div>

</div> <!-- End of bg-[#F5F5DC] container -->

<script>
    /**
     * Swaps the main product image and updates the active state of the thumbnails.
     * @param {HTMLElement} clickedThumb - The thumbnail element that was clicked.
     * @param {string} fullImageUrl - The full-size URL for the new main image.
     */
    function swapMedia(clickedThumb, fullImageUrl) {
        const display = document.getElementById('media-display');
        
        // 1. Update main image source and alt text
        display.src = fullImageUrl;
        display.alt = clickedThumb.alt;
        
        // 2. Update active state for all thumbnails
        document.querySelectorAll('.media-thumbnail').forEach(thumb => {
            // Remove active classes (blue border)
            thumb.classList.remove('border-blue-600', 'border-2', 'ring-2', 'ring-blue-600/50', 'shadow-md');
            // Add inactive styling (gray border, lower opacity)
            thumb.classList.add('border-gray-300', 'border', 'opacity-75');
        });
        
        // 3. Apply active state to the clicked thumbnail
        clickedThumb.classList.add('border-blue-600', 'border-2', 'ring-2', 'ring-blue-600/50', 'shadow-md');
        clickedThumb.classList.remove('border-gray-300', 'border', 'opacity-75');
    }

    // Safely inject styles for scrollbar hiding if not already present
    let scrollbarStyle = document.getElementById('scrollbar-style-fix');
    
    if (!scrollbarStyle) {
        const style = document.createElement('style');
        style.id = 'scrollbar-style-fix';
        style.innerHTML = `
            .no-scrollbar::-webkit-scrollbar { display: none; }
            .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        `;
        document.head.appendChild(style);
    }
</script>