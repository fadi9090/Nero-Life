{% comment %}
  Fixed Height Layout: Before/After Slider + LED Info Card - Matching Heights
{% endcomment %}

<style>
  .split-slider-container {
    display: flex;
    gap: 2rem;
    width: 100%;
    align-items: stretch;
  }
  
  .slider-wrapper {
    flex: 1;
    min-width: 0;
    display: flex;
    flex-direction: column;
  }
  
  .info-wrapper {
    flex: 1;
    min-width: 0;
    display: flex;
    flex-direction: column;
  }
  
  .simple-slider {
    position: relative;
    width: 100%;
    border-radius: 12px;
    overflow: hidden;
    background: #f8fafc;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    flex: 1; /* This makes slider fill available space */
  }
  
  .slider-images {
    position: relative;
    width: 100%;
    height: 100%;
  }
  
  .slider-images img {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  
  .slider-before {
    width: 50%;
    z-index: 2;
    clip-path: inset(0 50% 0 0);
  }
  
  .slider-after {
    z-index: 1;
  }
  
  .slider-line {
    position: absolute;
    top: 0;
    left: 50%;
    height: 100%;
    width: 3px;
    background: white;
    transform: translateX(-50%);
    box-shadow: 0 0 10px rgba(0,0,0,0.4);
    z-index: 3;
  }
  
  .slider-drag {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 44px;
    height: 44px;
    background: white;
    border-radius: 50%;
    cursor: ew-resize;
    z-index: 4;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    transition: all 0.2s ease;
  }
  
  .slider-drag:hover {
    transform: translate(-50%, -50%) scale(1.1);
    box-shadow: 0 6px 16px rgba(0,0,0,0.2);
  }
  
  /* Labels now inside the slider container */
  .slider-labels-container {
    display: flex;
    justify-content: space-between;
    margin-top: 1rem;
    padding: 0;
    height: auto;
  }
  
  .label-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1.25rem;
    background: white;
    border-radius: 8px;
    font-weight: 500;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
    border: 1px solid #e5e7eb;
    flex: 1;
    max-width: 48%;
  }
  
  .label-before {
    color: #dc2626;
  }
  
  .label-after {
    color: #059669;
  }
  
  .label-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
  }
  
  .label-before .label-dot {
    background: #dc2626;
  }
  
  .label-after .label-dot {
    background: #059669;
  }
  
  /* LED Info Card - Same height as slider */
  .led-info-card {
    background: white;
    border-radius: 12px;
    padding: 1.5rem;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    border: 1px solid #e5e7eb;
    height: 100%; /* This makes it match the slider wrapper height */
    display: flex;
    flex-direction: column;
  }
  
  .led-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem;
    flex-grow: 1;
  }
  
  .led-item {
    padding: 1rem;
    border-radius: 8px;
    transition: all 0.3s ease;
    border: 1px solid #f1f5f9;
  }
  
  .led-item:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  }
  
  .led-red {
    background: linear-gradient(135deg, #fef2f2, #fee2e2);
    border-left: 4px solid #dc2626;
  }
  
  .led-blue {
    background: linear-gradient(135deg, #eff6ff, #dbeafe);
    border-left: 4px solid #2563eb;
  }
  
  .led-green {
    background: linear-gradient(135deg, #f0fdf4, #dcfce7);
    border-left: 4px solid #059669;
  }
  
  .led-yellow {
    background: linear-gradient(135deg, #fefce8, #fef3c7);
    border-left: 4px solid #d97706;
  }
  
  .led-icon {
    width: 40px;
    height: 40px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 0.75rem;
  }
  
  .led-title {
    font-size: 1rem;
    font-weight: 600;
    margin-bottom: 0.25rem;
  }
  
  .led-subtitle {
    font-size: 0.875rem;
    font-weight: 500;
    margin-bottom: 0.5rem;
    opacity: 0.9;
  }
  
  .led-desc {
    font-size: 0.75rem;
    color: #6b7280;
    line-height: 1.4;
  }
  
  .treatment-stats {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem;
    margin-top: auto;
    padding-top: 1.5rem;
    border-top: 1px solid #e5e7eb;
  }
  
  .stat-box {
    text-align: center;
    padding: 0.75rem;
    background: #f8fafc;
    border-radius: 8px;
    transition: all 0.3s ease;
  }
  
  .stat-box:hover {
    background: #f1f5f9;
    transform: translateY(-2px);
  }
  
  .stat-value {
    font-size: 1.25rem;
    font-weight: 700;
    color: #0ea5e9;
    display: block;
    margin-bottom: 0.25rem;
  }
  
  .stat-label {
    font-size: 0.75rem;
    color: #6b7280;
    display: block;
  }
  
  .fda-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    background: #10b981;
    color: white;
    padding: 0.5rem 1rem;
    border-radius: 20px;
    font-size: 0.875rem;
    font-weight: 500;
    margin-top: 1rem;
    align-self: flex-start;
  }
  
  /* Animation for slider handle */
  @keyframes pulse {
    0%, 100% {
      transform: translate(-50%, -50%) scale(1);
    }
    50% {
      transform: translate(-50%, -50%) scale(1.05);
    }
  }
  
  .slider-drag {
    animation: pulse 3s infinite;
  }
  
  /* Responsive Design */
  @media (max-width: 768px) {
    .split-slider-container {
      flex-direction: column;
      gap: 2rem;
    }
    
    .slider-wrapper, .info-wrapper {
      width: 100%;
    }
    
    .led-grid {
      grid-template-columns: 1fr;
    }
    
    .treatment-stats {
      grid-template-columns: repeat(2, 1fr);
    }
    
    .simple-slider {
      height: 400px;
    }
    
    .led-info-card {
      height: auto;
    }
    
    .label-item {
      padding: 0.5rem 1rem;
    }
  }
  
  @media (min-width: 769px) and (max-width: 1024px) {
    .split-slider-container {
      gap: 1.5rem;
    }
    
    .led-grid {
      grid-template-columns: repeat(2, 1fr);
    }
    
    .treatment-stats {
      grid-template-columns: repeat(3, 1fr);
    }
  }
</style>

<div class="split-slider-container mb-8 bg-gray-50 p-6 rounded-2xl shadow-lg">
  <!-- Left Section: Before/After Slider with Labels -->
  <div class="slider-wrapper">
    <!-- Slider Box -->
    <div class="simple-slider" id="simpleSlider">
      <div class="slider-images">
        <img class="slider-after" 
             src="{{ 'after.jpeg' | asset_url }}" 
             alt="After 8 weeks of LED mask treatment"
             onerror="this.style.display='none'">
        
        <img class="slider-before" 
             src="{{ 'before.jpeg' | asset_url }}" 
             alt="Before using GlowPro LED mask"
             onerror="this.style.display='none'">
        
        <div class="slider-line" id="sliderLine"></div>
        
        <div class="slider-drag" id="sliderDrag">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#0ea5e9" stroke-width="2">
            <path d="M8 7l4-4 4 4M8 17l4 4 4-4M12 3v18"/>
          </svg>
        </div>
      </div>
    </div>
    
    <!-- Labels - Now part of the slider wrapper -->
    <div class="slider-labels-container">
      <div class="label-item label-before">
        <div class="label-dot"></div>
        <span>Before Treatment</span>
      </div>
      <div class="label-item label-after">
        <div class="label-dot"></div>
        <span>After 8 Weeks</span>
      </div>
    </div>
  </div>
  
  <!-- Right Section: LED Info Card -->
  <div class="info-wrapper">
    <div class="led-info-card">
      <h3 class="text-lg font-bold text-gray-900 mb-4">Advanced LED Technology</h3>
      
      <div class="led-grid">
        <!-- Red Light -->
        <div class="led-item led-red">
          <div class="led-icon bg-red-100">
            <div class="w-4 h-4 rounded-full bg-red-500"></div>
          </div>
          <div class="led-title text-red-700">Red Light</div>
          <div class="led-subtitle text-red-600">Anti-Aging</div>
          <p class="led-desc">Stimulates collagen production, reduces fine lines and wrinkles</p>
        </div>
        
        <!-- Blue Light -->
        <div class="led-item led-blue">
          <div class="led-icon bg-blue-100">
            <div class="w-4 h-4 rounded-full bg-blue-500"></div>
          </div>
          <div class="led-title text-blue-700">Blue Light</div>
          <div class="led-subtitle text-blue-600">Acne Treatment</div>
          <p class="led-desc">Eliminates acne-causing bacteria, reduces inflammation</p>
        </div>
        
        <!-- Green Light -->
        <div class="led-item led-green">
          <div class="led-icon bg-green-100">
            <div class="w-4 h-4 rounded-full bg-green-500"></div>
          </div>
          <div class="led-title text-green-700">Green Light</div>
          <div class="led-subtitle text-green-600">Brightening</div>
          <p class="led-desc">Reduces pigmentation, evens skin tone, enhances brightness</p>
        </div>
        
        <!-- Yellow Light -->
        <div class="led-item led-yellow">
          <div class="led-icon bg-yellow-100">
            <div class="w-4 h-4 rounded-full bg-yellow-500"></div>
          </div>
          <div class="led-title text-yellow-700">Yellow Light</div>
          <div class="led-subtitle text-yellow-600">Calming</div>
          <p class="led-desc">Reduces redness, soothes irritation, improves skin healing</p>
        </div>
      </div>
      
      <!-- Treatment Stats -->
      <div class="treatment-stats">
        <div class="stat-box">
          <span class="stat-value">10 min/day</span>
          <span class="stat-label">Treatment Time</span>
        </div>
        
        <div class="stat-box">
          <span class="stat-value">4-6 weeks</span>
          <span class="stat-label">Visible Results</span>
        </div>
        
        <div class="stat-box">
          <span class="stat-value">150+ LEDs</span>
          <span class="stat-label">LED Count</span>
        </div>
      </div>
      
      <!-- FDA Badge -->
      <div class="fda-badge">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M20 6L9 17l-5-5"/>
        </svg>
        <span>FDA Cleared</span>
      </div>
      
      <p class="text-sm text-gray-600 mt-4">Medical-grade LED technology used by dermatologists worldwide</p>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const beforeImg = document.querySelector('.slider-before');
    const line = document.getElementById('sliderLine');
    const drag = document.getElementById('sliderDrag');
    const slider = document.getElementById('simpleSlider');
    let dragging = false;
    
    function moveSlider(x) {
      const rect = slider.getBoundingClientRect();
      let pos = ((x - rect.left) / rect.width) * 100;
      pos = Math.max(0, Math.min(pos, 100));
      
      beforeImg.style.clipPath = `inset(0 ${100 - pos}% 0 0)`;
      line.style.left = `${pos}%`;
      drag.style.left = `${pos}%`;
    }
    
    drag.addEventListener('mousedown', () => {
      dragging = true;
      drag.style.animation = 'none';
    });
    
    slider.addEventListener('mousedown', (e) => {
      dragging = true;
      moveSlider(e.clientX);
      drag.style.animation = 'none';
    });
    
    document.addEventListener('mousemove', (e) => {
      if (dragging) moveSlider(e.clientX);
    });
    
    document.addEventListener('mouseup', () => {
      if (dragging) {
        dragging = false;
        drag.style.animation = 'pulse 3s infinite';
      }
    });
    
    // Touch support
    drag.addEventListener('touchstart', (e) => {
      e.preventDefault();
      dragging = true;
      drag.style.animation = 'none';
    });
    
    slider.addEventListener('touchstart', (e) => {
      dragging = true;
      moveSlider(e.touches[0].clientX);
      drag.style.animation = 'none';
    });
    
    document.addEventListener('touchmove', (e) => {
      if (dragging) moveSlider(e.touches[0].clientX);
    });
    
    document.addEventListener('touchend', () => {
      if (dragging) {
        dragging = false;
        drag.style.animation = 'pulse 3s infinite';
      }
    });
    
    // Keyboard support
    document.addEventListener('keydown', (e) => {
      const rect = slider.getBoundingClientRect();
      const currentPos = parseFloat(line.style.left) || 50;
      
      if (e.key === 'ArrowLeft') {
        moveSlider(rect.left + (rect.width * (currentPos - 5) / 100));
      } else if (e.key === 'ArrowRight') {
        moveSlider(rect.left + (rect.width * (currentPos + 5) / 100));
      }
    });
    
    // Match heights function
    function matchHeights() {
      const leftWrapper = document.querySelector('.slider-wrapper');
      const rightWrapper = document.querySelector('.info-wrapper');
      
      if (leftWrapper && rightWrapper) {
        const leftHeight = leftWrapper.offsetHeight;
        const rightHeight = rightWrapper.offsetHeight;
        
        // Set both to the taller height
        const maxHeight = Math.max(leftHeight, rightHeight);
        
        if (window.innerWidth > 768) { // Desktop only
          leftWrapper.style.height = maxHeight + 'px';
          rightWrapper.style.height = maxHeight + 'px';
        } else {
          // Reset on mobile
          leftWrapper.style.height = '';
          rightWrapper.style.height = '';
        }
      }
    }
    
    // Initial height match
    setTimeout(matchHeights, 100);
    
    // Update on window resize
    window.addEventListener('resize', matchHeights);
  });
</script>